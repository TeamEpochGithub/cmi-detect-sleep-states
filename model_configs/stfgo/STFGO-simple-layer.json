{
  "architecture": {
    "activation_delay": 32,
    "batch_size": 32,
    "early_stopping": 17,
    "epochs": 250,
    "loss": "shrinkage-loss",
    "lr": 0.006272938619890648,
    "lr_schedule": {
      "cycle_limit": 3,
      "lr_min": 0.002,
      "t_initial": 29,
      "warmup_lr_init": 0.000001,
      "warmup_t": 4
    },
    "mask_unlabeled": true,
    "network_params": {
      "attention": {
        "attn_mode": "all",
        "block_size": 110,
        "local_attn_ctx": 20,
        "type": "sparse"
      },
      "dropout": 0.8153959783987667,
      "emb_dim": 180,
      "expansion": 5,
      "heads": 5,
      "n_layers": 7,
      "pe": "fixed",
      "residual_model": {
        "activation": "relu",
        "bidir": true,
        "dropout": 0.3858931433504918,
        "hidden_size": 45,
        "n_layers": 8
      },
      "patch_size": 12
    },
    "optimizer": "adamw-torch",
    "threshold": 0,
    "type": "event-segmentation-transformer"
  },
  "data_info": {
    "downsampling_factor": 6,
    "latitude": 40.73061,
    "longitude": -73.935242,
    "window_size": 17280
  },
  "feature_engineering": [
    {
      "feats": [
        "anglez_diff_abs",
        "anglez_diff_abs_clip_10_savgol_180",
        "anglez_diff_abs_clip_10_median_180"
      ],
      "kind": "parser"
    },
    {
      "kind": "sun",
      "sun_features": [
        "azimuth",
        "altitude"
      ]
    },
    {
      "kind": "time",
      "time_features": [
        "hour",
        "minute",
        "weekday"
      ]
    }
  ],
  "name": "STFGO-simple-layer",
  "preprocessing": [
    {
      "kind": "mem_reduce"
    },
    {
      "as_feature": true,
      "kind": "similarity_nan"
    },
    {
      "events_path": "data/raw/train_events.csv",
      "fill_limit": 8640,
      "kind": "add_state_labels",
      "nan_tolerance_window": 5,
      "use_similarity_nan": true
    },
    {
      "events_path": "data/raw/train_events.csv",
      "kind": "add_event_labels",
      "smoothing": 5,
      "steepness": 2
    },
    {
      "kind": "split_windows"
    }
  ],
  "pretraining": {
    "downsample": {
      "features": [
        "f_anglez",
        "f_anglez_diff_abs",
        "f_enmo"
      ],
      "methods": [
        "min",
        "max",
        "mean",
        "std",
        "median",
        "range",
        "var"
      ],
      "standard": "mean"
    },
    "scaler": {
      "copy": true,
      "kind": "standard-scaler"
    },
    "test_size": 0.01
  }
}