{
    "name": "config",
    "log_to_wandb": true,
    "pred_with_cpu": false,
    "train_series_path": "data/raw/train_series.parquet",
    "train_events_path": "data/raw/train_events.csv",
    "test_series_path": "data/raw/test_series.parquet",
    "fe_loc_out": "data/features",
    "fe_loc_in": "data/processed",
    "processed_loc_out": "data/processed",
    "processed_loc_in": "data/raw",
    "model_store_loc": "tm",
    "data_info": {
        "window_size": 17280,
        "downsampling_factor": 1,
        "latitude": 40.730610,
        "longitude": -73.935242
    },
    "preprocessing": [
        {
            "kind": "mem_reduce",
            "id_encoding_path": "series_id_encoding.json"
        },
        {
            "kind": "similarity_nan",
            "as_feature": true
        },
        {
            "kind": "add_state_labels",
            "id_encoding_path": "series_id_encoding.json",
            "events_path": "data/raw/train_events.csv",
            "use_similarity_nan": true,
            "fill_limit": 8640,
            "nan_tolerance_window": 5
        },
        {
            "kind": "add_event_labels",
            "id_encoding_path": "series_id_encoding.json",
            "events_path": "data/raw/train_events.csv",
            "smoothing": 5,
            "steepness": 2
        },
        {
            "kind": "split_windows"
        }

    ],
    "feature_engineering": [{
        "kind": "time",
        "time_features": ["day", "hour", "minute", "second"]    
    },
    {
        "kind": "rotation",
        "window_sizes": [100]
    }
    ],

    "pretraining": {
        "test_size": 0.2,
        "scaler": {
            "kind": "standard-scaler",
            "copy": true
        }
    },
    "hpo": {
    },
    "models": {
        "Spectrogram_2D_Cnn": {
            "type": "Spectrogram_2D_Cnn",
            "loss": "mse-torch",
            "optimizer": "adam-torch",
            "epochs": 200,
            "batch_size": 16,
            "lr": 0.0005,
            "hidden_layers": 8,
            "early_stopping": 20,
            "threshold": 0,
            "n_fft": 63,
            "hop_length": 2,
            "encoder_name": "resnext50_32x4d",
            "encoder_weights": "imagenet",
            "bilinear": false,
            "scale_factor": 2,
            "mask_unlabeled": false,
            "encoder_depth": 5,
            "lr_schedule": {
                "t_initial": 15,
                "warmup_t": 5,
                "warmup_lr_init": 0.005,
                "lr_min": 2e-8
            } 
        }
        
    },
    "ensemble": {
        "models": ["Spectrogram_2D_Cnn"],
        "weights": [1],
        "comb_method": "addition"
    },
    "ensemble_loss": "mse-torch",
    "train_for_submission": true,
    "scoring": true,
    "visualize_preds": {
        "n": 0,
        "browser_plot": false,
        "save": true
    }
}